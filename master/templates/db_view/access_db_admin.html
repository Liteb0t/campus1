{% extends "_base.html" %}
{% load static %}
{% block title %}
 View Tables
{% endblock %}

{% block content %}

    <button onclick="showTable('students-table-container')">Students</button>
    <button onclick="showTable('submissions-table-container')">Submissions</button>
    <button onclick="showTable('jobs-table-container')">Jobs</button>
    <button onclick="showTable('linemanagers-table-container')">Line Managers</button>
    <div id="students-table-container"></div>
    <div id="submissions-table-container" style="display:none"></div>
    <div id="jobs-table-container" style="display:none"></div>
    <div id="linemanagers-table-container" style="display: none"></div>

    <script src="{% static 'table.js' %}"></script>
    <script>
	"use strict";
    const swappable_table_containers = [
        document.getElementById("students-table-container"),
        document.getElementById("submissions-table-container"),
        document.getElementById("jobs-table-container"),
        document.getElementById("linemanagers-table-container")
    ];
    function showTable(container_id) {
        for (let table_container of swappable_table_containers) {
            if (container_id === table_container.id) {
                table_container.style["display"] = "block";
            }
            else {
                table_container.style["display"] = "none";
            }
        }
    }
    let entries_per_page = 50;

    const students_table = new AdvancedSearchTable("students-table-container", {
        {#json: JSON.parse('{{ StudentsJSON|escapejs }}'),#}
        json_url: "{% url 'studentList' %}"
        ,columns: {
            "Username": {name: "username", type: "string", "parent_object": ["user"]}
            ,"First Name": {name: "first_name", type: "string", "parent_object": ["user"]}
            ,"Last Name": {name: "last_name", type: "string", "parent_object": ["user"]}
            ,"On Visa?": {name: "on_visa", type: "boolean"}
        }
    })
	const submissions_table = new AdvancedSearchTable("submissions-table-container", {
		json_url: "{% url 'submissionList' %}"
		,columns: {
			"Username": {name: "username", type: "string", "parent_object": ["student", "user"]}
			,"First Name": {name: "first_name", type: "string", "parent_object": ["student", "user"]}
            ,"Last Name": {name: "last_name", type: "string", "parent_object": ["student", "user"]}
			,"Job": {name: "job_name", type: "string"}
			,"Line Manager": {name: "username", type: "string", "parent_object": ["line_manager", "user"]}
			,"Hours": {name: "hours", type: "number"}
			,"Date worked": {name: "date_worked", type: "date"}
			,"Date submitted": {name: "date_submitted", type: "date"}
			,"Accepted": {name: "accepted", type: "boolean", display_name: "Accepted"}
        }
	});
	const jobs_table = new AdvancedSearchTable("jobs-table-container", {
		json_url: "{% url 'jobList' %}"
		,columns: {
			"Job Name": {name: "job_name", type: "string"}
			,"Cost Code": {name: "cost_code", type: "string"}
			,"Pay Rate": {name: "pay_rate", type: "number"}
			// ,"Students": {name: "username", type: "string", "parent_object": ["student", "user"]}
		}
	});
    const linemanagers_table = new AdvancedSearchTable("linemanagers-table-container", {
        json_url: "{% url 'lineManagerList' %}"
        ,columns: {
            "Username": {name: "username", type: "string", "parent_object": ["user"]}
            ,"First Name": {name: "first_name", type: "string", "parent_object": ["user"]}
            ,"Last Name": {name: "last_name", type: "string", "parent_object": ["user"]}
            // ,"Students": {name: "username", type: "string", "parent_object": ["student", "user"]}
        }
    })
			
    // students_table.populate();
    // students_tbody = new AdvancedSearchTbody("students-table-tbody", "students-table-pagination", "students-advanced-search", {
    {#//     json: JSON.parse('{{ StudentsJSON|escapejs }}')#}
    //     ,columns: ["username" ,"first_name" ,"last_name" ,"on_visa"]
    //     ,alias: "students"
    //     ,parameter_options: {"username": {type: "string"}, "first_name": {type: "string"}, "last_name": {type: "string"}}
    // });
    // students_tbody.populate();
	const fetch_response = fetch("{% url 'studentList' %}", {
		method: "POST",
		body: JSON.stringify({
			user: {
				username: "jsontest4"
				,first_name: "Mel"
				,last_name: "Stride"
				,email: "ijsadoif@sairoi.asifo"
			}
			,on_visa: true
		}),
		headers: {
			"Content-type": "application/json; charset=UTF-8"
		}
	});
    </script>
{% endblock %}

